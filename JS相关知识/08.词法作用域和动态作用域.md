## 作用域

- 作用域
    - `作用域`是程序源代码中定义变量的区域(变量可以被访问或调用的区域，亦或者是变量的生命周期)
    - 作用域规定了如何查找变量，也就是确定当前执行代码对变量的访问权限
- 词法作用域（又名:静态作用域）和动态作用域
    - 词法作用域和动态作用域都是作用域的`工作模式`
    - 词法作用域：函数的作用域在函数定义的时候就决定了
    - 动态作用域：函数的作用域在函数调用的时候才决定
    - 简而言之：词法作用域是在`定义时确定`的，而动态作用域是在`运行时确定`的
    - **JavaScript使用的是词法作用域**，它重要的特征是它的定义过程发生在代码的书写阶段
    - 例子
    ```js
      var a = 2;
      function foo() {
          console.log( a );
      }
      function bar() {
          var a = 3;
          foo();
      }
      bar();
    ```
    - 对于上述代码，如`果处于词法作用域，也就是现在的javascript环境`。变量a首先在foo()函数中查找，没有找到。于是就`根据书写的位置`，查找上面一层的代码，在这里是全局作用域，找到并赋值为2。所以控制台输出2
    - 对于上述代码，如果处于动态作用域，同样地，变量a首先在foo()中查找，没有找到。这里会`顺着调用栈在调用foo()函数的作用域`，也就是bar()函数中查找，找到并赋值为3。所以控制台输出3

- 词法作用域中的`遮蔽`
    - 作用域查找从运行时所处的最内部作用域开始，逐级向外或者说向上进行，直到遇见第一个匹配的标识符为
    - 在多层的嵌套作用域中可以定义同名的标识符，这叫作“遮蔽效应”，内部的标识符“遮蔽”了外部的标识符
    - 例子
        ```js
        var a = 0;
        function test(){
            var a = 1;
            console.log(a);//1
        }
        test();
        ```
    - 全局变量会自动为全局对象的属性，因此可以不直接通过全局对象的词法名称，而是间接地通过对全局对象属性的引用来对其进行访问
    - 例子
        ```js
        var a = 0;
        function test(){
            var a = 1;
            console.log(window.a);//0
        }
        test();
        ```
    - 通过这种技术可以访问那些被同名变量所遮蔽的全局变量。但非全局的变量如果被遮蔽了，无论如何都无法被访问到

- 额外补充的一点：
    - 例子
    ```js
      var scope = "global scope";
      function checkscope(){
          var scope = "local scope";
          function f(){
              return scope;
          }
          return f();
      }
      checkscope();// local scope
    ```
    ```js
    var scope = "global scope";
    function checkscope(){
        var scope = "local scope";
        function f(){
            return scope;
        }
        return f;
    }
    checkscope()();// local scope
    ```
    - 上述代码打印结果都为：local scope
    - 原因：因为JavaScript采用的是词法作用域，函数的作用域基于函数创建的位置
    - JavaScript 函数的执行用到了作用域链，这个作用域链是在函数定义的时候创建的。嵌套的函数 f() 定义在这个作用域链里，其中的变量 scope 一定是局部变量，不管何时何地执行函数 f()，这种绑定在执行 f() 时依然有效。
    - 虽然两段代码执行的结果一样，但是两段代码究竟有哪些不同呢？
    - 如果要回答这个问题，就要牵涉到很多的内容，词法作用域只是其中的一小部分，除此之外。还有`执行上下文栈`
